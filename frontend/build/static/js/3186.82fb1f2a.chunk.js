"use strict";(self.webpackChunkforntend=self.webpackChunkforntend||[]).push([[3186],{3186:(e,t,s)=>{s.r(t),s.d(t,{default:()=>n});var r=s(2791),a=s(2202),l=s(2903),c=s(184);const n=()=>{const[e,t]=(0,r.useState)([]),[s,n]=(0,r.useState)({}),[o,d]=(0,r.useState)(new Date),[x,i]=(0,r.useState)([]),[m,h]=(0,r.useState)([]),[u,g]=(0,r.useState)(!1),[p,j]=(0,r.useState)([1]),N=(0,r.useRef)(null),f=localStorage.getItem("selected_event_name"),y=localStorage.getItem("access_token");(0,r.useEffect)((()=>(N.current=new WebSocket(`wss://rpair.org/ws/competition_event/${f}/`),N.current.onopen=()=>{console.log("WebSocket connection established")},N.current.onmessage=e=>{const t=JSON.parse(e.data);console.log("Score Update:",t),t.game_id&&void 0!==t.score&&(i((e=>{const s=e.findIndex((e=>e.code===t.game_id));if(-1===s)return[...e,{code:t.game_id,team1:t.team1_name||"Team 1",team2:t.team2_name||"Team 2",score:t.score,round:t.round||1}];const r=[...e];return r[s]={...r[s],score:t.score},r})),d(new Date),t.round&&!p.includes(t.round)&&j((e=>[...e,t.round])))},N.current.onerror=e=>{console.error("WebSocket error:",e)},N.current.onclose=()=>{console.log("WebSocket connection closed")},()=>{N.current&&N.current.close()})),[f,p]);const b=e=>{switch(e){case 1:return(0,c.jsx)(a.PIe,{className:"text-yellow-400 text-xl"});case 2:return(0,c.jsx)(a.PIe,{className:"text-gray-400 text-xl"});default:return(0,c.jsx)(a.PIe,{className:"text-yellow-700 text-xl"})}};return(0,c.jsxs)("div",{className:"p-4 max-w-7xl mx-auto flex flex-col items-center",children:[(0,c.jsxs)("div",{className:"text-center mb-6",children:[(0,c.jsx)("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Live Skills Matches"}),(0,c.jsxs)("p",{className:"text-sm text-gray-600",children:["Last updated: ",o.toLocaleTimeString()]})]}),(0,c.jsx)("div",{className:"grid grid-cols-1 gap-8 w-full max-w-4xl",children:p.map((e=>(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-10 w-full text-center",children:[(0,c.jsxs)("h3",{className:"text-2xl font-bold mb-6",children:["Round ",e]}),(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)("table",{className:"w-full",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"bg-gray-100",children:[(0,c.jsx)("th",{className:"py-3 px-4 text-left text-lg",children:"Match Code"}),(0,c.jsx)("th",{className:"py-3 px-4 text-left text-lg",children:"Team"}),(0,c.jsx)("th",{className:"py-3 px-4 text-center text-lg",children:"Auto"}),(0,c.jsx)("th",{className:"py-3 px-4 text-center text-lg",children:"Driver"}),(0,c.jsx)("th",{className:"py-3 px-4 text-center text-lg",children:"Total"})]})}),(0,c.jsx)("tbody",{children:x.filter((t=>t.round===e)).map((e=>(0,c.jsxs)("tr",{className:"border-b hover:bg-gray-50",children:[(0,c.jsx)("td",{className:"py-3 px-4 text-lg",children:e.code}),(0,c.jsx)("td",{className:"py-3 px-4 text-lg",children:e.team1}),(0,c.jsx)("td",{className:"py-3 px-4 text-center text-lg",children:e.score.autonomous>0?(0,c.jsx)("span",{className:"text-green-600 font-medium",children:e.score.autonomous}):(0,c.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,c.jsx)("td",{className:"py-3 px-4 text-center text-lg",children:e.score.driver>0?(0,c.jsx)("span",{className:"text-blue-600 font-medium",children:e.score.driver}):(0,c.jsx)("span",{className:"text-gray-400",children:"-"})}),(0,c.jsx)("td",{className:"py-3 px-4 text-center text-lg font-bold",children:e.score.autonomous+e.score.driver>0?e.score.autonomous+e.score.driver:"-"})]},e.code)))})]})})]},e)))}),(0,c.jsx)("div",{className:"flex justify-center mt-6 mb-4",children:(0,c.jsxs)("button",{onClick:async()=>{if(f)try{const e=await l.Z.get(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/event/${f}/teamwork-rank`,{headers:{Authorization:`Bearer ${y}`}});console.log("API Response:",e.data),t(e.data),g(!0)}catch(e){console.error("Error fetching rankings:",e),e.response&&(console.log("Error response data:",e.response.data),console.log("Error response status:",e.response.status))}else console.error("No event name found")},className:"inline-flex items-center px-4 py-2 text-sm sm:text-base font-medium text-white bg-yellow-500 rounded-lg hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-yellow-500 transition-colors gap-2",children:[(0,c.jsx)(a.yyP,{className:"text-lg"}),(0,c.jsx)("span",{children:"View Ranking"})]})}),u&&(0,c.jsx)("div",{className:"mt-8",children:(0,c.jsxs)("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[(0,c.jsxs)("h2",{className:"text-2xl font-bold text-center mb-4 flex items-center justify-center gap-2",children:[(0,c.jsx)(a.yyP,{className:"text-yellow-500"}),"Team Rankings"]}),(0,c.jsx)("div",{className:"overflow-x-auto",children:(0,c.jsxs)("table",{className:"w-full",children:[(0,c.jsx)("thead",{children:(0,c.jsxs)("tr",{className:"bg-gray-800 text-white",children:[(0,c.jsx)("th",{className:"py-3 px-4 text-left rounded-tl-lg",children:"Rank"}),(0,c.jsx)("th",{className:"py-3 px-4 text-left",children:"Team"}),(0,c.jsx)("th",{className:"py-3 px-4 text-center rounded-tr-lg",children:"Average Score"})]})}),(0,c.jsx)("tbody",{children:e.map(((e,t)=>(0,c.jsxs)("tr",{className:`border-b ${0===t?"bg-yellow-100":1===t?"bg-gray-100":2===t?"bg-yellow-50":"bg-white"} hover:bg-gray-50 transition-colors`,children:[(0,c.jsxs)("td",{className:"py-3 px-4 flex items-center gap-2",children:[b(t+1),t+1]}),(0,c.jsx)("td",{className:"py-3 px-4 font-medium",children:e.team__name}),(0,c.jsx)("td",{className:"py-3 px-4 text-center font-bold",children:e.avg_score.toFixed(2)})]},e.team)))})]})})]})})]})}}}]);
//# sourceMappingURL=3186.82fb1f2a.chunk.js.map