"use strict";(self.webpackChunkforntend=self.webpackChunkforntend||[]).push([[3445],{3445:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var r=s(2791);class a extends Error{}function o(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return function(e){return decodeURIComponent(atob(e).replace(/(.)/g,((e,t)=>{let s=t.charCodeAt(0).toString(16).toUpperCase();return s.length<2&&(s="0"+s),"%"+s})))}(t)}catch(s){return atob(t)}}a.prototype.name="InvalidTokenError";var n=s(1758),l=s(6081),i=s(2602),c=s(2903),d=s(4022),u=s(9128),g=s(3050),p=s(184);const h=()=>{const[e,t]=(0,r.useState)(""),[s,h]=(0,r.useState)(""),[x,f]=(0,r.useState)(!1),[b,m]=(0,r.useState)(null),[w,y]=(0,r.useState)(!1),v=(0,i.s0)();(0,r.useEffect)((()=>{const{access_token:e}=(0,d.lz)();e&&v("/",{replace:!0})}),[v]);return(0,p.jsxs)("div",{className:"relative py-14 ",style:{backgroundImage:`url(${l})`,backgroundSize:"cover",backgroundPosition:"center"},children:[(0,p.jsx)(g.ql,{children:(0,p.jsx)("title",{children:"Login"})}),(0,p.jsx)("div",{className:"absolute bg-gray-50 inset-0 bg-opacity-50 z-0"}),(0,p.jsxs)("div",{id:"loginForm",className:"relative  flex bg-white rounded-2xl mb-10 shadow-lg overflow-hidden mx-auto max-w-sm lg:max-w-4xl",children:[(0,p.jsx)("div",{className:"hidden lg:block lg:w-1/3 bg-cover bg-gradient-to-br from-cyan-800 to-cyan-400",children:(0,p.jsxs)("div",{className:"flex items-center py-16 flex-col",children:[(0,p.jsx)("img",{src:n,alt:"Logo",className:"w-60"}),(0,p.jsx)(i.rU,{to:"/register",className:"text-center text-white font-bold py-2 border border-white w-36 rounded-full",children:"Sign Up"})]})}),(0,p.jsxs)("div",{className:"w-full p-8 lg:w-1/2 flex flex-col mx-auto",children:[(0,p.jsx)("h2",{className:"text-3xl font-bold text-gray-700 text-center pb-4",children:"Login"}),(0,p.jsx)("span",{className:"border-b w-full "}),(0,p.jsxs)("form",{className:"mt-6",onSubmit:async t=>{if(t.preventDefault(),f(!0),m(null),!e||!s)return m("Username and password are required."),void f(!1);try{console.log("REACT_APP_API_URL_AUTH","https://rpair.org/api/user/auth");const{data:r}=await c.Z.post("https://rpair.org/api/user/auth/login/",{username:e,password:s},{headers:{"Content-Type":"application/json"},withCredentials:!0});(0,d.Fm)({access_token:r.access_token,refresh_token:r.refresh_token});const n=function(e,s){if("string"!==typeof e)throw new a("Invalid token specified: must be a string");s||(s={});const r=!0===s.header?0:1,n=e.split(".")[r];if("string"!==typeof n)throw new a(`Invalid token specified: missing part #${r+1}`);let l;try{l=o(n)}catch(t){throw new a(`Invalid token specified: invalid base64 for part #${r+1} (${t.message})`)}try{return JSON.parse(l)}catch(t){throw new a(`Invalid token specified: invalid json for part #${r+1} (${t.message})`)}}(r.access_token);localStorage.setItem("user_role",JSON.stringify({is_superuser:(null===n||void 0===n?void 0:n.is_superuser)||!1,is_staff:(null===n||void 0===n?void 0:n.is_staff)||!1})),v("/",{replace:!0})}catch(l){var r,n;m((null===(r=l.response)||void 0===r||null===(n=r.data)||void 0===n?void 0:n.detail)||"Login failed. Check your credentials.")}finally{f(!1)}},children:[b&&(0,p.jsx)("div",{className:"mt-4 text-sm text-red-600",children:b}),(0,p.jsxs)("div",{children:[(0,p.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"User Name"}),(0,p.jsx)("input",{className:"bg-gray-200 text-gray-700 focus:outline-none focus:ring-2 focus:ring-cyan-600 focus:shadow-md border border-gray-300 rounded py-2 px-4 block w-full",type:"text",placeholder:"Enter your username",value:e,onChange:e=>t(e.target.value),required:!0})]}),(0,p.jsxs)("div",{className:"mt-4 relative",children:[(0,p.jsxs)("div",{className:"flex justify-between ",children:[(0,p.jsx)("label",{className:"block text-gray-700 text-sm font-bold mb-2",children:"Password"}),(0,p.jsx)(i.rU,{to:"/reset-password",className:"text-xs text-cyan-500 hover:underline","aria-label":"Forgot Password",children:"Forgot Password?"})]}),(0,p.jsx)("input",{className:"bg-gray-200 text-gray-700 focus:outline-none focus:ring-2 focus:ring-cyan-600 focus:shadow-md border border-gray-300 rounded py-2 px-4 block w-full",type:w?"text":"password",placeholder:"Enter your password",value:s,onChange:e=>h(e.target.value),required:!0}),(0,p.jsx)("button",{className:"absolute right-4 top-9 text-3xl",type:"button",onClick:()=>{y((e=>!e))},children:w?(0,p.jsx)(u.GKB,{}):(0,p.jsx)(u.wT3,{})})]}),(0,p.jsx)("button",{type:"submit",className:`mt-8 font-bold py-2 px-4 w-full rounded ${x?"bg-gray-400 cursor-not-allowed":"bg-cyan-800 hover:bg-cyan-600"} transition-all duration-700 cursor-pointer text-white`,disabled:x,children:x?"Logging in...":"Login"})]})]})]})]})}}}]);
//# sourceMappingURL=3445.9d4d374b.chunk.js.map