"use strict";(self.webpackChunkforntend=self.webpackChunkforntend||[]).push([[9480],{9480:(e,t,s)=>{s.r(t),s.d(t,{default:()=>x});var l=s(2791),a=s(2202),n=s(9108),r=s(5804),i=s(1830),d=s.n(i),o=s(184);const c=e=>{let{onCalculate:t,onClose:s,mode:n,gameId:i}=e;const[d,c]=(0,l.useState)(0),[m,x]=(0,l.useState)(0),[u,h]=(0,l.useState)(0),[g,b]=(0,l.useState)(60),[v,p]=(0,l.useState)(!1),[j,y]=(0,l.useState)(!1),[f,N]=(0,l.useState)(!1),w=(0,l.useRef)(null),S=localStorage.getItem("selected_event_name"),[_,C]=(0,l.useState)(!1),k=(localStorage.getItem("access_token"),(0,l.useMemo)((()=>d*("auto"===n?2:1)+((e,t)=>{let s="auto"===n?6:4;return 4===e?s="auto"===n?18:12:3===e?s="auto"===n?14:10:2===e&&(s="auto"===n?10:8),s*t})(d,m)),[d,m,n]));(0,l.useEffect)((()=>(w.current=new WebSocket(`wss://rpair.org/ws/competition_event/${S}/game/${i}/`),w.current.onopen=()=>{console.log("WebSocket connection established")},w.current.onmessage=e=>{const t=JSON.parse(e.data);"paused"!==t.status?"resume"!==t.status?void 0!==t.remaining_time&&(b(Math.round(t.remaining_time)),t.remaining_time<=0&&(p(!1),N(!0))):y(!1):y(!0)},()=>{w.current&&(w.current.close(),console.log("WebSocket connection closed"))})),[S,i]);return(0,o.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4",children:(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-2xl w-full max-w-md overflow-hidden",children:[(0,o.jsxs)("div",{className:"flex justify-between items-center p-4 border-b border-gray-200",children:[(0,o.jsx)("h2",{className:"text-xl font-bold text-gray-800",children:"Game Score"}),(0,o.jsx)("button",{onClick:s,className:"text-gray-500 hover:text-red-600 transition-colors",children:(0,o.jsx)(a.aHS,{size:24})})]}),(0,o.jsx)("div",{className:"p-4 bg-gray-50",children:(0,o.jsxs)("div",{className:"text-center text-2xl font-bold text-gray-800",children:["Current Score: ",(0,o.jsx)("span",{className:"text-green-600",children:k})]})}),(0,o.jsxs)("div",{className:"p-4",children:[(0,o.jsxs)("div",{className:"flex justify-center space-x-4 mb-4",children:[!_&&(0,o.jsx)("button",{onClick:()=>{p(!0),y(!1),C(!0),N(!1),w.current&&w.current.send(JSON.stringify({action:"start_game",event_name:S,game_id:i}))},disabled:v,className:"bg-blue-500 text-white p-3 rounded-full shadow-md hover:bg-blue-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)(a.gmG,{size:18})}),_&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:()=>{v&&!j&&(w.current&&w.current.send(JSON.stringify({action:"pause_game",event_name:S,game_id:i})),y(!0))},disabled:!v||j,className:"bg-yellow-500 text-white p-3 rounded-full shadow-md hover:bg-yellow-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)(a.Wh,{size:18})}),(0,o.jsx)("button",{onClick:()=>{v&&j&&(w.current&&w.current.send(JSON.stringify({action:"resume_game",event_name:S,game_id:i})),y(!1))},disabled:!j,className:"bg-green-500 text-white p-3 rounded-full shadow-md hover:bg-green-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)(r.zPJ,{size:18})}),(0,o.jsx)("button",{onClick:()=>{w.current&&w.current.send(JSON.stringify({action:"restart_game",event_name:S,game_id:i})),b(60),y(!1),N(!1)},disabled:!v,className:"bg-red-500 text-white p-3 rounded-full shadow-md hover:bg-red-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,o.jsx)(a.lbL,{size:18})})]})]}),(0,o.jsx)("div",{className:"text-center text-lg font-bold text-red-600 bg-gray-100 p-2 rounded-lg shadow-sm",children:j?"Game Paused":f?"Time's Up!":`Remaining Time: ${g} seconds`})]}),(0,o.jsx)("div",{className:"p-4",children:[{label:"Switch",count:d,setCount:c,icon:(0,o.jsx)(a.WLu,{size:20,className:"text-blue-500"})},{label:"Goal",count:m,setCount:x,icon:(0,o.jsx)(a.ULU,{size:20,className:"text-green-500"})}].map((e=>{let{label:t,count:s,setCount:l,icon:a}=e;return(0,o.jsxs)("div",{className:"flex items-center justify-between bg-gray-100 p-3 rounded-lg mb-3 shadow-md",children:[(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[a,(0,o.jsx)("span",{className:"font-semibold text-gray-700",children:t})]}),(0,o.jsxs)("div",{className:"flex items-center gap-2",children:[(0,o.jsx)("button",{onClick:()=>l("Switch"===t?Math.min(4,s+1):s+1),disabled:!v,className:"bg-blue-500 text-white px-3 py-1 rounded-lg hover:bg-blue-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:"+"}),(0,o.jsx)("span",{className:"text-lg font-bold",children:s}),(0,o.jsx)("button",{onClick:()=>l(Math.max(0,s-1)),className:"bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!v,children:"-"})]})]},t)}))}),(0,o.jsx)("div",{className:"p-4 border-t border-gray-200",children:(0,o.jsx)("button",{onClick:()=>{t(k||0),s()},disabled:v||!f,className:"w-full bg-green-500 text-white py-2 rounded-lg text-lg font-semibold shadow-md hover:bg-green-600 transition-transform transform hover:scale-105 disabled:opacity-50 disabled:cursor-not-allowed",children:f?"Calculate & Submit Score":"Submit Score (Time's Up)"})})]})})};var m=s(2903);const x=()=>{const[e,t]=(0,l.useState)({1:!0,2:!1,3:!1}),[s,r]=(0,l.useState)({}),[i,x]=(0,l.useState)({}),[u,h]=(0,l.useState)(!1),[g,b]=(0,l.useState)(null),[v,p]=(0,l.useState)(null),[j,y]=(0,l.useState)(null),[f,N]=(0,l.useState)(!1),[w,S]=(0,l.useState)([]),[_,C]=(0,l.useState)(""),[k,T]=(0,l.useState)("driver"),A=localStorage.getItem("selected_event_name"),E=localStorage.getItem("access_token"),O=async(e,l)=>{var a,n,r,o,c,u;if(!w.find((e=>e.id===l)))return;x((t=>({...t,[e]:{...t[e],[l]:!0}}))),e<3&&(e=>w.every((t=>{var s;return!0===(null===(s=i[e])||void 0===s?void 0:s[t.id])})))(e)&&t((t=>({...t,[e+1]:!0})));const h={event_name:A,score:{driver:null!==(a=null===(n=s[e])||void 0===n||null===(r=n[l])||void 0===r?void 0:r.driver)&&void 0!==a?a:"0",autonomous:null!==(o=null===(c=s[e])||void 0===c||null===(u=c[l])||void 0===u?void 0:u.auto)&&void 0!==o?o:"0"}};try{const e=await m.Z.post(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/game/${l}/set-game-score/`,h,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}});console.log("Score submitted successfully:",e.data),d().fire({icon:"success",title:"Success",text:"Score submitted successfully!",showConfirmButton:!0,confirmButtonColor:"#28a745"})}catch(g){console.error("Error submitting score:",g)}},R=e=>{let{children:t,className:s}=e;return(0,o.jsx)("th",{className:`px-2.5 py-2 sm:px-4 sm:py-3 text-xs sm:text-sm font-medium text-gray-500 uppercase tracking-wider text-center ${s}`,children:t})},P=e=>{let{children:t,className:s}=e;return(0,o.jsx)("td",{className:`px-2.5 py-2 sm:px-4 sm:py-3 text-sm text-gray-900 text-center ${s}`,children:t})};return(0,o.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,o.jsxs)("div",{className:"text-center mb-8",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold text-black mb-5 ",children:"\ud83c\udfc6 Skills Challenge"}),(0,o.jsx)("div",{className:"flex justify-center mb-6",children:(0,o.jsx)("div",{className:"inline-flex rounded-md shadow-sm",children:[{id:"driver",label:"Driving Challenge",icon:"\ud83d\ude97",color:"blue"},{id:"auto",label:"Autonomous Challenge",icon:"\ud83e\udd16",color:"blue"}].map((e=>(0,o.jsxs)("button",{onClick:()=>T(e.id),className:`px-6 py-2 text-sm font-medium flex items-center gap-2 ${k===e.id?"bg-black text-white":"bg-white text-gray-700 hover:bg-gray-50"} ${"driver"===e.id?"rounded-l-lg":"rounded-r-lg"}`,children:[(0,o.jsx)("span",{className:"text-xl",children:e.icon}),e.label]},e.id)))})}),(0,o.jsx)("div",{className:"flex justify-center mb-6",children:(0,o.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=await m.Z.post(`${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL}/event/${A}/games-schedule/`,{stage:"skills",time:_},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${E}`}});console.log("Schedule posted successfully:",e.data),S(e.data)}catch(t){console.error("Error posting schedule:",t)}},className:"flex gap-4 items-center",children:[(0,o.jsx)("input",{type:"time",value:_,onChange:e=>C(e.target.value),className:"px-4 py-2 rounded-md border border-gray-300 focus:ring-2 focus:ring-white text-lg"}),(0,o.jsx)("button",{type:"submit",className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded-md transition-all",children:"View Schedule"})]})}),(0,o.jsxs)("div",{className:"flex justify-center items-center gap-4 mt-4",children:[(0,o.jsx)("button",{onClick:()=>p((e=>Math.max(1,e-1))),disabled:1===v,className:"p-2 rounded-full "+(1===v?"bg-gray-200 text-gray-400":"bg-indigo-100 text-black hover:bg-indigo-200"),children:(0,o.jsx)(a.bUI,{})}),(0,o.jsxs)("span",{className:"text-xl font-semibold bg-slate-900 text-white px-4 py-2 rounded-full",children:["Round ",v]}),(0,o.jsx)("button",{onClick:()=>p((e=>Math.min(3,e+1))),disabled:3===v,className:"p-2 rounded-full "+(3===v?"bg-gray-200 text-gray-400":"bg-indigo-100 text-black hover:bg-indigo-200"),children:(0,o.jsx)(a.Dli,{})})]})]}),(0,o.jsx)("div",{className:"bg-white shadow-xl rounded-xl overflow-hidden mb-8",children:(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-50",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)(R,{children:"Team"}),(0,o.jsx)(R,{children:"Match Code"}),(0,o.jsx)(R,{children:"driver"===k?"Driver Score":"Auto Score"}),(0,o.jsx)(R,{children:"Status"}),(0,o.jsx)(R,{children:"Actions"})]})}),(0,o.jsx)("tbody",{className:"divide-y divide-gray-200",children:w.map((e=>{var t,l,d,c,m,x,u,g,j,f,N,w;return(0,o.jsxs)("tr",{className:null!==(t=i[v])&&void 0!==t&&t[e.id]?"bg-green-50":"hover:bg-gray-50",children:[(0,o.jsx)(P,{children:e.team1}),(0,o.jsx)(P,{children:e.id}),(0,o.jsxs)(P,{children:["driver"===k?null!==(l=null===(d=s[v])||void 0===d||null===(c=d[e.id])||void 0===c?void 0:c.driver)&&void 0!==l?l:0:null!==(m=null===(x=s[v])||void 0===x||null===(u=x[e.id])||void 0===u?void 0:u.auto)&&void 0!==m?m:0,!(null!==(g=i[v])&&void 0!==g&&g[e.id])&&(0,o.jsx)("button",{onClick:()=>((e,t,s)=>{var l;null!==(l=i[t])&&void 0!==l&&l[e.id]||(b(e),p(t),y(s),h(!0),r((s=>{const l={...s};return l[t]||(l[t]={}),l[t][e.id]||(l[t][e.id]={auto:0,driver:0}),l})))})(e,v,k),className:"ml-2 text-green-600 hover:text-green-800",children:(0,o.jsx)(n.pXb,{className:"inline"})})]}),(0,o.jsx)(P,{children:(0,o.jsx)("span",{className:"px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full "+(null!==(j=i[v])&&void 0!==j&&j[e.id]?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"),children:null!==(f=i[v])&&void 0!==f&&f[e.id]?"Confirmed":"Pending"})}),(0,o.jsx)(P,{children:(0,o.jsxs)("button",{onClick:()=>O(v,e.id),disabled:null===(N=i[v])||void 0===N?void 0:N[e.id],className:"px-3 py-1 rounded-md text-sm "+(null!==(w=i[v])&&void 0!==w&&w[e.id]?"bg-gray-300 text-gray-600":"bg-green-600 hover:bg-green-700 text-white"),children:[(0,o.jsx)(a.l_A,{className:"inline mr-1"})," Confirm"]})})]},e.id)}))})]})})}),(0,o.jsx)("div",{className:"flex justify-center gap-4 mb-8",children:(0,o.jsxs)("button",{onClick:()=>N(!f),className:"px-6 py-2 bg-yellow-500 hover:bg-yellow-600 text-white rounded-lg flex items-center",children:[(0,o.jsx)(a.yyP,{className:"mr-2"}),f?"Hide Rankings":"View Rankings"]})}),f&&(0,o.jsxs)("div",{className:"bg-white shadow-xl rounded-xl overflow-hidden mb-8",children:[(0,o.jsxs)("div",{className:"px-6 py-4 bg-white text-black flex items-center",children:[(0,o.jsx)(a.yyP,{className:"mr-2"}),(0,o.jsx)("h2",{className:"text-xl font-bold",children:"Overall Rankings"})]}),(0,o.jsx)("div",{className:"overflow-x-auto",children:(0,o.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,o.jsx)("thead",{className:"bg-gray-100",children:(0,o.jsxs)("tr",{children:[(0,o.jsx)(R,{className:"px-6 py-3 text-left",children:"Rank"}),(0,o.jsx)(R,{className:"px-6 py-3 text-left",children:"Team"}),(0,o.jsx)(R,{className:"px-6 py-3 text-center",children:"Avg Auto"}),(0,o.jsx)(R,{className:"px-6 py-3 text-center",children:"Avg Driver"}),(0,o.jsx)(R,{className:"px-6 py-3 text-center",children:"Total"})]})}),(0,o.jsx)("tbody",{className:"divide-y divide-gray-200",children:w.map((e=>{let t=0,l=0,a=0;return Object.values(s).forEach((s=>{s[e.id]&&(t+=s[e.id].auto||0,l+=s[e.id].driver||0,a++)})),{id:e.id,name:e.team1,autoAvg:a>0?(t/a).toFixed(2):"0.00",driverAvg:a>0?(l/a).toFixed(2):"0.00",total:a>0?((t+l)/a).toFixed(2):"0.00"}})).sort(((e,t)=>t.total-e.total)).map(((e,t)=>({...e,rank:t+1}))).map(((e,t)=>(0,o.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,o.jsxs)(R,{className:"px-6 py-4 font-medium",children:[t+1,t<3&&(0,o.jsx)("span",{className:"ml-2",children:0===t?"\ud83e\udd47":1===t?"\ud83e\udd48":"\ud83e\udd49"})]}),(0,o.jsx)(R,{className:"px-6 py-4",children:e.name}),(0,o.jsx)(R,{className:"px-6 py-4 text-center",children:e.autoAvg}),(0,o.jsx)(R,{className:"px-6 py-4 text-center",children:e.driverAvg}),(0,o.jsx)(R,{className:"px-6 py-4 text-center font-bold text-indigo-600",children:e.total})]},e.id)))})]})})]}),u&&g&&v&&(0,o.jsx)(c,{onCalculate:e=>{g&&v&&j&&(r((t=>{const s={...t};return s[v]||(s[v]={}),s[v][g.id]||(s[v][g.id]={auto:0,driver:0}),s[v][g.id][j]=null!==e&&void 0!==e?e:0,s})),h(!1))},onClose:()=>h(!1),gameId:g.id})]})}}}]);
//# sourceMappingURL=9480.6e06d46a.chunk.js.map